extends layout
block content
  .container
    h2 Registration Keys
    .success
    .error
    form(id='form1' action='/addKey' method= 'post')
      input#id(type='hidden', name='id', value='')
      table
        tr
          td(style='text-align: center')
            input#key(type='text', name='key', placeholder='Key', value='')
            | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            input#subbtn.btn(type='submit', name='sub', value='Add Key')
    table.table
      tbody
        tr
          th Key
          th Action
        if data.length
         each item in data
          tr
            td #{item['key']}
            td
               a.editlink(href='javascript:void(0)', data-id='#{item["_id"]}') Edit
               | &nbsp;&nbsp;
               a(href='/deleteKey?id=#{item["_id"]}', onclick='return confirm("You are going to delete this key. Continue?")') Delete

    script(src='https://code.jquery.com/jquery-3.1.1.min.js')
    script.

      $(function() { 

        $('.editlink').on('click', function(){

          var id = $(this).data('id');

          $.ajax({

            method: "GET",

            url: "/fetchdataKey",

            data: { id:  id },

          }).done(function( data ) {

            $('#id').val(data[0]['_id']);

            $('#key').val(data[0]['key']);

            $("#subbtn").val('Edit Key');

            $('#form1').attr('action', '/editKey');

          });

        });

      });